#:kivy 1.1.0
#:import kivy kivy
#:import win kivy.core.window

<CheckBoxList>:
    cols: 2

<ConfirmPopup>:
    content:
    GridLayout:
        rows: 2
        Label:
            text: root.confirm_prompt
            font_size: '20sp'
        GridLayout:
            cols: 2
            Button:
                text: "Cancel"
                font_size: '20sp'
                on_release: root.clear()
            Button:
                text: "OK"
                font_size: '20sp'
                on_release: root.ok_confirm()

<LoadScreen>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"
        FileChooserListView:
            id: filechooser
            on_submit: root.app.load_game_file_cb(self.path, self.selection)
            rootpath: "games"
    BoxLayout:
        size_hint_y: None
        height: 30
        Button:
            text: "New Game"
            on_release: root.app.new_game_cb()
        Button:
            text: "Load"
            on_release: root.app.load_game_file_cb(filechooser.path, filechooser.selection)

<PlayerScreen>:
    GridLayout:
        cols: 2
        height:120

        GridLayout:
            cols:2
            height:20
            MyLabel:
                text: 'Player'
            Spinner:
                values: root.players
            TextInput
                text: ''
                id: black_name_id
            CheckBoxList:
                group: 'player_type'
                text: ''
                values: ('Human', 'Computer')
                id: type_id

        CheckBoxList:
            group: 'max_depth'
            text: 'Max Depth'
            values: ('0', '2', '4', '6', '8', '10', '12')
            id: max_depth_id

        Button:
            size_hint: (.2, .2)
            text: 'Return'
            on_press: root.start_game() # TODO
            id: start_button

<MenuScreen>:
    GridLayout:
        cols: 1
        size_hint: 1, .5

        Button:
            text: "New Game"
            on_release: root.app.new_gameX_cb()

        Button:
            text: "Load Game"
            # TODO
            # on_release: root.app.load_game_file_cb(filechooser.path, filechooser.selection)

        Button:
            text: "Edit Players"
            on_release: root.app.show_players_cb()

        Button:
            text: "Review Game"
            # TODO

        Button:
            text: "Options"
            # TODO

        Button:
            text: "Show Demo"
            # TODO

        # TODO: Edit openings?

#Help
#Sound effects volume
#Music volume
#Start/Resume
<OptionsScreen>:
    GridLayout:
        cols: 2
        size_hint: 1, 1

        Button:
            text: "Instructions"
            on_release: root.app.show_instructions()

        Button:
            text: "Rules"
            on_release: root.app.show_rules()

        MyLabel:
            text: "Mark last 2 moves?"
        ToggleButton:
            font_size: '20sp'
            state: 'down'
            id: mm_widget
            on_press: root.set_mark_moves(mm_widget.state)

        MyLabel:
            text: "Mark recent captures?"
        ToggleButton:
            font_size: '20sp'
            state: 'down'
            id: rc_widget
            on_press: root.set_mark_captures(rc_widget.state)

        MyLabel:
            text: "Confirm moves?"

        CheckBoxList:
            text: "Confirm style"
			group: "confirm_options"
			values: ["None", "Off Board", "On Piece"]
			on_val: root.set_confirm_mode(self.val)

        # TODO: Music and Sound Effects

        Button:
            text: "Resume"
            on_release: root.app.show_game()

# Player selection: Spinner
<NewGameScreen>:
    GridLayout:
        cols: 1
        GridLayout:
            cols: 2
            size_hint: 1, None
            height: 200


            CheckBoxList:
                text: 'Rules'
                group: 'rules'
                values: ['standard', 'tournament', 'keryo', 'freestyle', '5', 'no']
                id: rules_id

            CheckBoxList:
                text: 'Board Size'
                group: 'board_size'
                values: ['9', '13', '19']
                id: bs_id

            
        GridLayout:
            cols: 2
            height:120

            GridLayout:
                cols:2
                height:120
                MyLabel:
                    text: 'Black\nPlayer\nName'
                TextInput
                    text: 'Black'
                    id: black_name_id
                CheckBoxList:
                    group: 'black_type'
                    text: ''
                    values: ('Human', 'Computer')
                    id: black_type_id

            GridLayout:
                cols:2
                height:50
                MyLabel:
                    text: 'White\nPlayer\nName'
                TextInput
                    text: 'White'
                    id: white_name_id
                CheckBoxList:
                    group: 'white_type'
                    text: ''
                    values: ('Human', 'Computer')
                    id: white_type_id

            CheckBoxList:
                group: 'max_depth'
                text: 'Max Depth'
                values: ('0', '2', '4', '6', '8', '10', '12')
                id: max_depth_id

            Button:
                size_hint: (.2, .2)
                text: 'Start Game'
                on_press: root.start_game()
                id: start_button

<SetupScreen>:
    GridLayout:
        cols: 1
        GridLayout:
            cols: 2
            size_hint: 1, None
            height: 200


            CheckBoxList:
                text: 'Rules'
                group: 'rules'
                values: ['standard', 'tournament', 'keryo', 'freestyle', '5', 'no']
                id: rules_id

            CheckBoxList:
                text: 'Board Size'
                group: 'board_size'
                values: ['9', '13', '19']
                id: bs_id

            
        GridLayout:
            cols: 2
            height:120

            GridLayout:
                cols:2
                height:120
                MyLabel:
                    text: 'Black\nPlayer\nName'
                TextInput
                    text: 'Black'
                    id: black_name_id
                CheckBoxList:
                    group: 'black_type'
                    text: ''
                    values: ('Human', 'Computer')
                    id: black_type_id

            GridLayout:
                cols:2
                height:50
                MyLabel:
                    text: 'White\nPlayer\nName'
                TextInput
                    text: 'White'
                    id: white_name_id
                CheckBoxList:
                    group: 'white_type'
                    text: ''
                    values: ('Human', 'Computer')
                    id: white_type_id

            CheckBoxList:
                group: 'max_depth'
                text: 'Max Depth'
                values: ('0', '2', '4', '6', '8', '10', '12')
                id: max_depth_id

            Button:
                size_hint: (.2, .2)
                text: 'Start Game'
                on_press: root.start_game()
                id: start_button


<MyLabel@Label>:
    font_size: '25sp'

<PenteScreen>:
    RelativeLayout:
        pos: self.parent.board_offset
        canvas:
            Rectangle:
                source: 'media/41-old-wooden-board.jpg'
                size: self.size
            Color:
                rgba: 0, 0, 0, 1
            Line:
                points: root.gridlines
                width: 2.0
            Color:
                rgba: root.border_colour
            Line:
                points: root.border_lines
                joint: 'none'
                width: 6

    GridLayout:
        cols: 2
        size_hint: 1, None
        height: root.board_offset[1]
        canvas.before:
            Color:
                rgba: 0, 0, .5, 1
            Rectangle:
                # self here refers to the widget i.e GridLayout
                pos: self.pos
                size: self.size
        GridLayout:
            rows: 1

            GridLayout:
                size_hint_x: .3
                cols: 1
                Button:
                    font_size: '20sp'
                    text: "Options"
                    on_release: root.app.show_options()
                Button:
                    font_size: '20sp'
                    text: "Beginning"
                    on_release: root.go_to_the_beginning()
                Button:
                    font_size: '20sp'
                    text: "Back"
                    on_release: root.go_backwards_one()
                Button:
                    font_size: '20sp'
                    text: "Forward"
                    on_release: root.go_forwards_one()
                Button:
                    font_size: '20sp'
                    text: "End"
                    on_release: root.go_to_the_end()
            GridLayout:
                rows: 2
                # TODO: duplication
                MyLabel:
                    # TODO: times
                    # TODO: BLACK/WHITE
                    text: root.player_time[1]
                MyLabel:
                MyLabel:
                    text: root.player_name[1]
                MyLabel:
    
                MyLabel:
                    # TODO: times
                    text: root.player_time[2]
                MyLabel:
                MyLabel:
                    text: root.player_name[2]
                MyLabel:

<Piece>:
    Image:
        id: image
        source: root.source
        center: 0, 0

